<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>工程定位</title>
    <link href="../../vendor/css/font-awesome.min.css-v=4.4.0.css" rel="stylesheet">
    <link href="../../vendor/css/bootstrap.min.css-v=3.3.5.css" rel="stylesheet">
    <!-- Morris -->
    <link href="../../vendor/css/plugins/morris/morris-0.4.3.min.css" rel="stylesheet">


    <link href="../../vendor/css/animate.min.css" rel="stylesheet">
    <link href="../../vendor/css/style.min.css-v=4.0.0.css" rel="stylesheet">
    <link href="../../vendor/css/plugins/morris/morris-0.4.3.min.css"
          tppabs="http://www.zi-han.net/theme/hplus/css/plugins/morris/morris-0.4.3.min.css" rel="stylesheet">

    <script type="text/javascript"
            src="http://api.map.baidu.com/api?v=2.0&ak=KpautMd4SUq1m5ArEOPRwEBGWWAPII4g"></script>
    <style>
        #map {
            border: 1px solid #000
        }

        .table-condensed > thead > tr > th,
        .table-condensed > tbody > tr > th,
        .table-condensed > tfoot > tr > th,
        .table-condensed > thead > tr > td,
        .table-condensed > tbody > tr > td,
        .table-condensed > tfoot > tr > td,
        .panel-body {
            padding: 5px;
        }

        .form-group {
            margin-bottom: 5px;
        }

        #page {
            text-align: center;
            padding: 5px;
        }

        .pager {
            margin: 5px 0;
        }

        label.BMapLabel {
            max-width: inherit;
        }
    </style>
</head>

<body class="gray-bg">
<div class="wrapper wrapper-content">
    <div class="row">
        <div class="col-sm-8" id="map" style="height: 630px;"></div>
        <div class="col-sm-4">
            <div class="row">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title">工程查询</h3>
                    </div>
                    <div class="panel-body">
                        <form class="form-horizontal" role="form">
                            <div class="form-group form-group-sm">
                                <label for="type" class="col-sm-2 control-label">类型: </label>
                                <div class="col-sm-10">
                                    <!--<input type="text" class="form-control" id="type">-->
                                    <select name="type" id="type" class="form-control">
                                        <option value="0">不限</option>
                                        <option value="1">涵洞</option>
                                        <option value="2">桥梁</option>
                                        <option value="3">涵洞</option>
                                        <option value="4">漕洞</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group form-group-sm">
                                <label for="town" class="col-sm-2 control-label">乡镇: </label>
                                <div class="col-sm-10">
                                    <select name="type" id="town" class="form-control">
                                        <option value="0">不限</option>
                                        <option value="1">憨里1号</option>
                                        <option value="2">憨里2号</option>
                                        <option value="3">憨里3号</option>
                                        <option value="4">憨里4号</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group form-group-sm">
                                <label for="name" class="col-sm-2 control-label">名称: </label>
                                <div class="col-sm-10">
                                    <input type="text" class="form-control" id="name">
                                </div>
                            </div>
                            <div class="form-group form-group-sm">
                                <div class="col-sm-offset-2 col-sm-10">
                                    <button type="submit" class="btn btn-default btn-sm">查询</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="row panel panel-default">
                <table class="table table-hover table-bordered table-condensed  margin">
                    <thead>
                    <tr>
                        <th style="background-color: #337ab7; color: #fff;">类型</th>
                        <th style="background-color: #337ab7; color: #fff;">名称</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>涵洞基本情况</td>
                        <td>
                            <a class="location" data-location="123,123">南昌大学破桥洞</a>
                        </td>
                    </tr>
                    <tr>
                        <td>桥梁基本情况</td>
                        <td>
                            <a class="location" data-location="123,123">南昌大学渣渣桥</a>
                        </td>
                    </tr>
                    <tr>
                        <td>河道基本情况</td>
                        <td>
                            <a class="location" data-location="123,123">南昌大学泥沙河</a>
                        </td>
                    </tr>
                    <tr>
                        <td>涵洞基本情况</td>
                        <td>
                            <a class="location" data-location="123,123">南昌大学破桥洞</a>
                        </td>
                    </tr>
                    <tr>
                        <td>桥梁基本情况</td>
                        <td>
                            <a class="location" data-location="123,123">南昌大学渣渣桥</a>
                        </td>
                    </tr>
                    <tr>
                        <td>河道基本情况</td>
                        <td>
                            <a class="location" data-location="123,123">南昌大学泥沙河</a>
                        </td>
                    </tr>
                    <tr>
                        <td>涵洞基本情况</td>
                        <td>
                            <a class="location" data-location="123,123">南昌大学破桥洞</a>
                        </td>
                    </tr>
                    <tr>
                        <td>桥梁基本情况</td>
                        <td>
                            <a class="location" data-location="123,123">南昌大学渣渣桥</a>
                        </td>
                    </tr>
                    <tr>
                        <td>河道基本情况</td>
                        <td>
                            <a class="location" data-location="123,123">南昌大学泥沙河</a>
                        </td>
                    </tr>
                    <tr>
                        <td>河道基本情况</td>
                        <td>
                            <a class="location" data-location="123,123">南昌大学泥沙河</a>
                        </td>
                    </tr>
                    <tr>
                        <td>河道基本情况</td>
                        <td>
                            <a class="location" data-location="123,123">南昌大学泥沙河</a>
                        </td>
                    </tr>
                    <tr>
                        <td>河道基本情况</td>
                        <td>
                            <a class="location" data-location="123,123">南昌大学泥沙河</a>
                        </td>
                    </tr>
                    </tbody>
                </table>

                <nav>
                    <ul class="pager">
                        <li><a href="#">上一页</a></li>
                        <li><input type="text" style="width: 45px;text-align: center" placeholder="1"></li>
                        <li><a href="#">下一页</a></li>
                    </ul>
                </nav>
                <p id="page">
                    当前每页显示 12 条, 共有 <span id="sum">2783</span> 条
                </p>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    var gotoMap = function (lon, lat, infoText) {
        /*实际坐标*/
        var y = lon || 34.6023128282,
                x = lat || 119.2282296287,
                infoText = infoText || "连云港市";

        /*地图初始化*/
        var map = new BMap.Map("map");          // 创建地图实例
        var point = new BMap.Point(x, y);             // 创建点坐标
        map.centerAndZoom(point, 15);                 // 初始化地图，设置中心点坐标和地图级别
        map.addControl(new BMap.NavigationControl());
        map.addControl(new BMap.ScaleControl());
        map.addControl(new BMap.OverviewMapControl({isOpen: true}));
        map.addControl(new BMap.MapTypeControl({mapTypes: [BMAP_NORMAL_MAP, BMAP_HYBRID_MAP]}));

        var marker = new BMap.Marker(point);  // 创建红点标注
        map.addOverlay(marker);               // 将标注添加到地图中
        marker.setAnimation(BMAP_ANIMATION_BOUNCE); //跳动的动画

        setTimeout(function () {
            map.removeOverlay(marker);
            var stopMarker = new BMap.Marker(point);  // 创建静止红点标注
            map.addOverlay(stopMarker);               // 将标注添加到地图中
        }, 3000);

        if (infoText.length > 0) {
            console.info(infoText);
            var opts = {
                position: point,    // 指定文本标注所在的地理位置
                offset: new BMap.Size(15, -25)    //设置文本偏移量
            }
            var label = new BMap.Label(String(infoText), opts);  // 创建文本标注对象
            label.setStyle({
                color: "blue",
                fontSize: "12px",
                height: "20px",
                lineHeight: "20px",
                fontFamily: "微软雅黑"
            });
            map.addOverlay(label);
        }
    }
    window.onload = gotoMap();
</script>
<script src="../../vendor/js/jquery.min.js-v=2.1.4.js"></script>
<script src="../../vendor/js/bootstrap.min.js-v=3.3.5.js"></script>
<script src="../../vendor/js/plugins/flot/jquery.flot.js"></script>
<script src="../../vendor/js/plugins/flot/jquery.flot.tooltip.min.js"></script>
<script src="../../vendor/js/plugins/flot/jquery.flot.spline.js"></script>
<script src="../../vendor/js/plugins/flot/jquery.flot.resize.js"></script>
<script src="../../vendor/js/plugins/flot/jquery.flot.symbol.js"></script>
<script src="../../vendor/js/plugins/peity/jquery.peity.min.js"></script>
<script src="../../vendor/js/demo/peity-demo.min.js"></script>
<script src="../../vendor/js/content.min.js-v=1.0.0.js"></script>
<script src="../../vendor/js/plugins/jquery-ui/jquery-ui.min.js"></script>
<script src="../../vendor/js/plugins/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
<script src="../../vendor/js/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
<script src="../../vendor/js/plugins/sparkline/jquery.sparkline.min.js"></script>
<script src="../../vendor/js/demo/sparkline-demo.min.js"></script>

<script>
    $(".location").bind('click', function (e) {
        e.preventDefault();
        console.log('refreshMap');
        var location = $(this).data('location');
        var x = location.split(',')[0];
        var y = location.split(',')[1];
        var info = $(this).html();
        gotoMap(x, y, info);
    })
</script>
</body>
</html>